buildscript {
	ext {
        CxSBSDK = "0.4.5"
        //cxVersion = "8.90.5"
        springBootVersion = '2.2.4.RELEASE'
        sonarqubeVersion = '2.8'
        atlassianVersion = "5.1.6"
        atlassianFugueVersion = "4.7.2"
        mainClass='com.checkmarx.flow.CxFlowApplication'
    }
	repositories {
        jcenter()
        mavenLocal()
		mavenCentral()
        maven {
            url = 'https://packages.atlassian.com/mvn/maven-external'
        }
        gradlePluginPortal()
	}
	dependencies {
        classpath ("gradle.plugin.com.gorylenko.gradle-git-properties:gradle-git-properties:2.0.0")
        classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}")
        classpath "org.sonarsource.scanner.gradle:sonarqube-gradle-plugin:${sonarqubeVersion}"
    }
   /*gradle.projectsEvaluated {
        tasks.withType(JavaCompile) {
            options.compilerArgs << "-Xlint:unchecked"
        }
    }
    */
}

apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'org.springframework.boot'
apply plugin: 'io.spring.dependency-management'
apply plugin: 'com.gorylenko.gradle-git-properties'

group = 'com.checkmarx'
version = '1.5.3'
sourceCompatibility = 1.8

repositories {
    jcenter()
    mavenLocal()
    mavenCentral()
    maven {
        url = 'https://packages.atlassian.com/mvn/maven-external'
    }
    gradlePluginPortal()

}

dependencies {
    compile('org.springframework.boot:spring-boot-starter-actuator')
	compile('org.springframework.boot:spring-boot-starter-web')
	compile('org.springframework.boot:spring-boot-starter-aop')
    compile("com.github.checkmarx-ts:cx-spring-boot-sdk:${CxSBSDK}")
    compile ("org.apache.commons:commons-text:1.8")
    compile ('commons-codec:commons-codec:1.13')
    compile ('commons-io:commons-io:2.6')
    compile ('org.json:json:20190722')
    compile ('com.fasterxml.jackson.core:jackson-databind')
    compile ('org.springframework.boot:spring-boot-starter-web-services')
    compile ('org.springframework.boot:spring-boot-starter-mail')
    compile ('org.springframework.boot:spring-boot-starter-thymeleaf')
    compile ('com.github.ulisesbocchio:jasypt-spring-boot-starter:2.1.2')
    compile ("io.atlassian.fugue:fugue:${atlassianFugueVersion}")
    compile ("com.atlassian.jira:jira-rest-java-client-core:${atlassianVersion}")
    compile ("com.atlassian.jira:jira-rest-java-client-api:${atlassianVersion}")
    compile ("org.apache.httpcomponents:httpclient:4.5.10")
    compile ("org.thymeleaf:thymeleaf:3.0.11.RELEASE")
    compile ("org.codehaus.groovy:groovy-all:2.5.8")
    compile ("org.apache.ivy:ivy:2.5.0")
    compile ("org.eclipse.jgit:org.eclipse.jgit:5.5.1.201910021850-r")
    compileOnly ('org.springframework.boot:spring-boot-configuration-processor')
    runtime('org.springframework.boot:spring-boot-devtools')
    testCompile('org.springframework.boot:spring-boot-starter-test')
    compileJava.dependsOn(processResources)
}

springBoot {
    mainClassName = "${mainClass}"
    buildInfo()
}

bootJar {
    mainClassName = "${mainClass}"
}

test {
    useJUnit {
        systemProperty "testprofile", "unit"
    }
}

task integrationTest(type: Test) {
    useJUnit {
        systemProperty "testprofile", "integration"
    }
}

task getVersion {
    doLast {
        println "${version}"
    }
}
